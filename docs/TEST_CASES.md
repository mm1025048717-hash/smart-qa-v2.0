# 智能问答界面测试问题清单

> 基于《智能问答界面重构PRD_V3.0》的完整测试集
> 用于验证意图识别准确率和可视化匹配正确性

---

## 📋 测试覆盖范围

| PRD章节 | 测试内容 | 用例数量 |
|--------|---------|---------|
| 3.1 意图识别映射矩阵 | 13种意图类型 | 39个 |
| 4.1-4.5 可视化映射表 | 5大类查询 | 25个 |
| 5.3 叙事流程示例 | 完整分析场景 | 4个 |
| 10.2 验收测试场景 | 官方验收用例 | 4个 |

**总计: 72个测试用例**

---

## 一、意图识别测试集 (基于PRD 3.1)

### 1.1 L1层级 - 简单查询

#### 🔹 单指标查询 (single_metric)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L1-01 | 今年销售额是多少 | `::kpi::` | 显示数值+同比环比+季度明细 |
| L1-02 | 本月订单量有多少 | `::kpi::` | 显示订单数+趋势标签 |
| L1-03 | 当前库存数值 | `::kpi::` | 显示库存量 |

#### 🔹 多指标并列 (multi_metric)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L1-04 | 销售额和订单量 | `::kpi-group::` | 并排显示2个指标 |
| L1-05 | 看一下营收以及利润 | `::kpi-group::` | 并排显示+提示对比分析 |
| L1-06 | 日活还有月活数据 | `::kpi-group::` | 并排显示DAU/MAU |

---

### 1.2 L2层级 - 分析查询

#### 🔹 时间趋势 (trend_analysis)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-01 | 近3个月销售额趋势 | `::kpi::` + `::line-chart::` | 显示趋势折线图 |
| L2-02 | 今年销售额变化情况 | `::line-chart::` | 按月展示走势 |
| L2-03 | 最近一周订单量波动 | `::line-chart::` | 日粒度趋势图 |

#### 🔹 同比环比 (yoy_mom)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-04 | 本月销售额比上月如何 | `::kpi::` + `::line-chart::` | 高亮环比变化 |
| L2-05 | 对比去年和今年营收 | `::line-chart::` | 双系列对比图 |
| L2-06 | Q3销售额同比增长情况 | `::kpi::` + `::bar-chart::` | 显示增长率 |

#### 🔹 构成分析 (composition)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-07 | 销售渠道占比分析 | `::pie-chart::` | 饼图+占比说明 |
| L2-08 | 各品类销售额构成 | `::pie-chart::` | 超6项合并为"其他" |
| L2-09 | 用户年龄分布比例 | `::pie-chart::` | 年龄分组展示 |

#### 🔹 维度对比 (dimension_compare)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-10 | 各地区销售额对比 | `::bar-chart::` | 柱状图+排序 |
| L2-11 | 分产品线看销量 | `::bar-chart::` | 产品维度拆解 |
| L2-12 | 各渠道转化率哪个最好 | `::bar-chart::` | 添加基准线 |

#### 🔹 双指标评估 (quadrant)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-13 | 分析产品健康度 | `::quadrant-chart::` | 四象限图(需预配置) |
| L2-14 | 销售额和利润率的关系 | `::quadrant-chart::` | 需业务阈值配置 |
| L2-15 | 同时看客单价和复购率 | `::scatter-chart::` | 散点图+趋势线 |

#### 🔹 地域分布 (geography)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-16 | 各省份销售分布 | `::map-chart::` | 地图分级设色 |
| L2-17 | 用户地域分布情况 | `::map-chart::` | 支持省/市下钻 |
| L2-18 | 各城市订单量热力图 | `::map-chart::` | 热区可点击 |

#### 🔹 排名排序 (ranking)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-19 | TOP10销售城市 | `::bar-chart::` | 降序排列 |
| L2-20 | 销量最低的5个产品 | `::bar-chart::` | 升序排列 |
| L2-21 | 各门店业绩排名 | `::bar-chart::` | 支持正/倒序切换 |

#### 🔹 异常检测 (anomaly)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-22 | 找出异常交易数据 | `::box-plot::` | 标注离群点 |
| L2-23 | 昨天订单量突降原因 | `::line-chart::` | 标注异常点+原因列表 |
| L2-24 | 检测销售额不正常的区域 | `::bar-chart::` | 高亮异常值 |

#### 🔹 原因分析 (attribution)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-25 | 为什么销售额下降 | 多组件组合 | 归因叙事+因素拆解 |
| L2-26 | 分析转化率偏低的原因 | `::funnel-chart::` + 文字 | 分步骤诊断 |
| L2-27 | 利润下滑的影响因素 | `::bar-chart::` + `::pie-chart::` | 权重展示 |

#### 🔹 预测请求 (prediction)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L2-28 | 预测下月销售额 | `::kpi::` + `::line-chart::` | 显示置信区间 |
| L2-29 | 未来一周订单趋势预测 | `::line-chart::` | 预测线+区间 |
| L2-30 | 预计Q4能完成多少营收 | `::kpi::` | 预测值+依据说明 |

---

### 1.3 L3层级 - 下钻探索

#### 🔹 下钻探索 (drill_down)
| ID | 测试问题 | 期望组件 | 期望行为 |
|----|---------|---------|---------|
| L3-01 | 详细看看华东区数据 | 上下文相关 | 保持原上下文+局部更新 |
| L3-02 | 展开说说杭州的情况 | 上下文相关 | 下钻到城市维度 |
| L3-03 | 具体到各门店分析 | 上下文相关 | 进一步下钻 |

---

## 二、可视化映射测试集 (基于PRD 4.1-4.5)

### 2.1 时间相关查询
| ID | 测试问题 | 期望解析 | 期望组件 |
|----|---------|---------|---------|
| T-01 | 本月销售额 | 时间:当月, 指标:销售额 | `::kpi::` + 同比环比 |
| T-02 | 2024年各季度利润 | 时间:年+季度, 指标:利润 | `::bar-chart::` X轴Q1-Q4 |
| T-03 | 近30天日活趋势 | 时间:30天, 粒度:日 | `::line-chart::` 标注周末 |
| T-04 | 对比去年和今年营收 | 时间:两年对比 | `::line-chart::` 双系列 |
| T-05 | 每小时订单量变化 | 粒度:小时 | `::line-chart::` 24点 |

### 2.2 维度对比查询
| ID | 测试问题 | 期望解析 | 期望组件 |
|----|---------|---------|---------|
| D-01 | 各产品线销售额 | 维度:产品线 | `::bar-chart::` 降序 |
| D-02 | 前五大省份销量 | 维度:地区, 数量:5 | `::bar-chart::` TOP5 |
| D-03 | 渠道转化率对比 | 维度:渠道 | `::bar-chart::` +基准线 |
| D-04 | 各年龄段用户占比 | 维度:年龄分段 | `::pie-chart::` |
| D-05 | 不同价格段销量分布 | 维度:价格段 | `::bar-chart::` 按价格排序 |

### 2.3 构成与分布查询
| ID | 测试问题 | 期望解析 | 期望组件 |
|----|---------|---------|---------|
| C-01 | 销售额品类构成 | 分组:品类 | `::pie-chart::` 其他<5%合并 |
| C-02 | 用户地域分布 | 维度:地域 | `::map-chart::` 分级设色 |
| C-03 | 流量来源渠道 | 分组:渠道 | `::pie-chart::` 环图 |
| C-04 | 库存各状态占比 | 分组:状态 | `::pie-chart::` 颜色编码 |
| C-05 | 费用各科目比例 | 分组:科目 | `::bar-chart::` 堆叠柱状图 |

### 2.4 关系与关联分析
| ID | 测试问题 | 期望解析 | 期望组件 |
|----|---------|---------|---------|
| R-01 | 客单价与复购率关系 | 指标1:客单价, 指标2:复购率 | `::scatter-chart::` +趋势线 |
| R-02 | 营销费用与销售额关系 | X:费用, Y:销售额 | `::quadrant-chart::` |
| R-03 | 温度与销量相关性 | 维度:温度, 指标:销量 | `::scatter-chart::` +相关系数 |
| R-04 | 广告曝光与点击关系 | X:曝光, Y:点击 | `::scatter-chart::` +CTR |

### 2.5 分析与诊断查询
| ID | 测试问题 | 期望解析 | 期望组件 |
|----|---------|---------|---------|
| A-01 | 分析销量下降原因 | 类型:归因 | 多图表组合 |
| A-02 | 为什么转化率偏低 | 类型:诊断 | `::funnel-chart::` |
| A-03 | 找出异常交易 | 类型:异常检测 | `::box-plot::` |
| A-04 | 预测下月销售额 | 类型:预测 | `::line-chart::` +置信区间 |

---

## 三、复合意图测试集 (基于PRD 3.2)

| ID | 测试问题 | 组合方案 | 优先级规则 |
|----|---------|---------|----------|
| M-01 | 11月销售额趋势及构成 | `::line-chart::` + `::pie-chart::` | 分析>查询 |
| M-02 | 各地区销售额排名及同比 | `::bar-chart::` + `::line-chart::` | 时间维度优先 |
| M-03 | 本月销售额和环比变化 | `::kpi::` + `::line-chart::` | 同比环比意图 |
| M-04 | 各渠道占比及趋势对比 | `::pie-chart::` + `::bar-chart::` | 复合分析 |

---

## 四、PRD官方验收场景 (基于PRD 10.2)

### 场景1: 简单趋势查询
```
输入: "最近三个月销售额趋势"

✅ 检查项:
[ ] 1. ::h2:: "近三个月销售额趋势分析" 标题
[ ] 2. ::kpi:: 当前月销售额及同比
[ ] 3. ::line-chart:: 三个月趋势折线图
[ ] 4. ::p:: 趋势描述文字
[ ] 5. ::action-button:: "查看详细周趋势"、"对比去年同期"
```

### 场景2: 多维度构成分析
```
输入: "各渠道销售额占比及趋势"

✅ 检查项:
[ ] 1. ::h2:: "销售渠道分析" 标题
[ ] 2. ::kpi-group:: 总销售额、渠道数
[ ] 3. ::pie-chart:: 渠道占比饼图
[ ] 4. ::bar-chart:: 各渠道月度对比
[ ] 5. ::drill-area:: 主要渠道可下钻
```

### 场景3: 异常检测与归因
```
输入: "为什么昨日订单量异常下降"

✅ 检查项:
[ ] 1. ::h2:: "昨日订单异常分析" 标题
[ ] 2. ::kpi:: 订单量（红色负增长标记）
[ ] 3. ::line-chart:: 周趋势，标注昨日异常点
[ ] 4. ::box-plot:: 历史订单分布，显示昨日为离群点
[ ] 5. ::p:: 可能原因列表
[ ] 6. ::action-button:: "查看时段分布"、"检查系统日志"
```

### 场景4: 移动端复杂查询
```
设备: iPhone企业微信
输入: "本月各城市销售额TOP5及地图分布"

✅ 检查项:
[ ] 1. 布局自适应，无水平滚动条
[ ] 2. ::bar-chart:: TOP5柱状图可左右滑动
[ ] 3. ::map-chart:: 点击省份可放大查看
[ ] 4. 所有交互元素触摸友好(≥44×44px)
```

---

## 五、叙事流程测试集 (基于PRD 5.3)

### 完整分析叙事流程测试
```
输入: "分析11月华东区销售额下降原因"

✅ 渲染顺序检查:
[ ] Step 1: ::h2:: "11月华东区销售额分析报告"
[ ] Step 2: ::kpi:: 销售额 1.2亿（环比-15%，同比-8%）
[ ] Step 3: ::p:: 文字说明开场
[ ] Step 4: ::line-chart:: 月度趋势图（断崖式下降）
[ ] Step 5: ::p:: 趋势分析文字
[ ] Step 6: ::bar-chart:: 分城市对比
[ ] Step 7: ::p:: 关键发现（杭州、南京下降明显）
[ ] Step 8: ::drill-area:: 下钻热区
[ ] Step 9: ::action-button:: 追问建议

✅ 叙事逻辑检查:
[ ] 问题确认与范围界定
[ ] 核心指标总览
[ ] 多维度拆解分析
[ ] 异常点识别
[ ] 下钻建议
```

---

## 六、交互组件测试集 (基于PRD 6.1.4)

| ID | 组件 | 测试场景 | 期望行为 |
|----|-----|---------|---------|
| I-01 | `::drill-area::` | 点击图表关键数据点 | 触发L3意图，原叙事中插入下钻分析 |
| I-02 | `::action-button::` | 点击追问建议 | 自动发送预设问题 |
| I-03 | `::control-bar::` | 长报告场景 | 支持暂停/仅结论/导出 |
| I-04 | 图表hover | 悬停数据点 | 显示详细数值tooltip |
| I-05 | KPI点击 | 点击主KPI卡片 | 触发下钻或显示口径 |

---

## 七、边界条件测试集

### 7.1 空结果处理
| ID | 测试问题 | 期望行为 |
|----|---------|---------|
| E-01 | 2030年销售额趋势 | 友好提示无数据 |
| E-02 | 火星地区销售分布 | 提示无匹配维度 |

### 7.2 模糊意图处理
| ID | 测试问题 | 期望行为 |
|----|---------|---------|
| E-03 | 销售 | 追问确认具体需求 |
| E-04 | 看看数据 | 引导用户明确意图 |
| E-05 | 帮我分析一下 | 提供常见分析选项 |

### 7.3 复杂长问题
| ID | 测试问题 | 期望行为 |
|----|---------|---------|
| E-06 | 分析2024年Q1-Q3各地区各产品线销售额同比环比变化趋势并找出异常 | 拆解为多步骤分析 |

---

## 八、性能测试集 (基于PRD 9.1)

| ID | 测试场景 | 指标 | 目标值 |
|----|---------|-----|-------|
| P-01 | 简单查询首字节 | TTFB | < 1.5s |
| P-02 | 流式渲染延迟 | 块间隔 | < 200ms |
| P-03 | 移动端加载(4G) | 完整加载 | < 3s |
| P-04 | 1000点折线图渲染 | 图表绘制 | < 1s |

---

## 📊 测试结果汇总模板

| 类别 | 总用例 | 通过 | 失败 | 通过率 |
|-----|-------|-----|-----|-------|
| L1意图识别 | 6 | - | - | -% |
| L2意图识别 | 30 | - | - | -% |
| L3意图识别 | 3 | - | - | -% |
| 可视化映射 | 23 | - | - | -% |
| 复合意图 | 4 | - | - | -% |
| 官方验收场景 | 4 | - | - | -% |
| 叙事流程 | 1 | - | - | -% |
| 交互组件 | 5 | - | - | -% |
| 边界条件 | 6 | - | - | -% |
| **总计** | **82** | - | - | -% |

**PRD验收目标: 可视化匹配准确率 > 85%**

---

## 🔄 测试执行说明

### 执行步骤
1. 启动项目: `npm run dev`
2. 打开浏览器: http://localhost:3000
3. 依次输入测试问题
4. 对照期望输出检查结果
5. 记录通过/失败状态

### 标注规范
- ✅ 完全符合预期
- ⚠️ 部分符合，有改进空间
- ❌ 不符合预期
- 🔄 需要人工判断

---

*测试集版本: V1.0*  
*基于PRD版本: V3.0*  
*创建日期: 2025-12-04*

