# 🎤 启动语音服务 - 快速指南

## ⚡ 一键启动（推荐）

运行以下脚本之一：

```bash
一键启动语音服务.bat
```

或：

```bash
修复WebSocket连接.bat
```

## 📋 启动步骤

### 1. 检查服务状态

运行诊断脚本：
```bash
诊断语音服务.bat
```

### 2. 启动服务

**方法 A: 使用批处理脚本（推荐）**
```bash
cd voice-backend
启动服务.bat
```

**方法 B: 直接运行 Python**
```bash
cd voice-backend
python voice_bot.py
```

### 3. 等待启动完成

看到以下消息表示启动成功：
```
WebSocket server ready on ws://localhost:8765
```

### 4. 刷新浏览器

**重要**：服务启动后，必须刷新浏览器页面（按 F5），前端才能连接到语音服务。

## ✅ 验证连接

启动服务并刷新浏览器后：

1. **查看连接状态指示器**（语音按钮旁的小圆点）
   - 🟢 **绿色** = 已连接，可以使用
   - ⚪ **灰色** = 未连接

2. **测试语音功能**
   - 点击麦克风图标
   - 允许麦克风权限
   - 开始说话

## ❌ 常见问题

### Q: 服务启动失败？

**检查清单**：
- ✅ Python 是否已安装（运行 `python --version`）
- ✅ 依赖是否已安装（运行 `voice-backend\install.bat`）
- ✅ `.env` 文件是否配置正确
- ✅ 端口 8765 是否被占用

### Q: 服务已启动但按钮仍然无法点击？

**解决方案**：
1. **刷新浏览器页面**（必须！）
2. 检查浏览器控制台是否有其他错误
3. 检查连接状态指示器是否为绿色
4. 确保已允许麦克风权限

### Q: 控制台仍有 WebSocket 错误？

这是正常的。如果语音服务未运行，浏览器会显示连接失败的错误。这些错误不会影响其他功能。

**解决方法**：
- 启动语音服务（见上方步骤）
- 或者忽略这些错误（如果不使用语音功能）

## 💡 提示

- **服务需要一直运行**：不要关闭启动服务的命令行窗口
- **首次启动较慢**：需要下载模型，请耐心等待（约 20 秒）
- **必须刷新浏览器**：服务启动后必须刷新页面才能连接
- **检查端口占用**：如果端口被占用，运行 `修复WebSocket连接.bat` 会自动处理

## 🆘 需要帮助？

运行诊断脚本获取详细信息：
```bash
诊断语音服务.bat
```

