import XLSX from 'xlsx';
import path from 'path';
import { fileURLToPath } from 'url';

const __dirname = path.dirname(fileURLToPath(import.meta.url));

const headers = ['功能名称', '类型', '功能描述', '优先级', '状态', '负责人', '计划版本', '发布版本', '所属模块'];

const rows = [
  ['查看仪表盘列表', '视图', '查看所有已创建的仪表板列表，包括名称、发布状态、创建者、修改人、修改时间等', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['搜索仪表板', '操作', '根据关键词在仪表板列表中进行搜索', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['筛选仪表板', '操作', '根据状态、类型等条件筛选仪表板列表', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['新建仪表板', '操作', '弹出创建仪表板对话框，创建并配置新仪表板', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['填写看板名称', '操作', '在创建对话框中输入仪表板名称，必填项', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['填写简称', '操作', '在创建对话框中输入仪表板简称，可选项', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['添加标签', '操作', '在创建/编辑对话框中为仪表板添加分类标签', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['确认创建看板', '操作', '提交仪表板信息，完成创建', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['取消创建', '操作', '关闭创建对话框，放弃本次创建', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['选择仪表板', '操作', '通过复选框选择一个或多个仪表板，为批量操作做准备', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['预览/查看仪表板', '视图', '点击查看图标，预览或查看仪表板详细内容（含预置固化报表及自定义仪表盘）', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['编辑仪表板名称/标签', '操作', '修改仪表板的名称、简称、标签等属性', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['收藏仪表板', '操作', '将仪表板标记为收藏，方便快速访问', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['更多仪表板操作', '操作', '通过三点菜单提供删除、分享等操作', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['删除仪表盘', '操作', '从仪表盘列表中删除不需要的仪表盘', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['管理发布状态', '操作', '查看并设置仪表板的发布状态（如未发布）', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['控制仪表板显示', '操作', '通过「仪表板示」等复选框控制列表显示模式或选项', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['筛选仪表盘（全局）', '操作', '对仪表盘进行全局时间、机构或标签等条件筛选', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['返回目录', '操作', '从仪表盘详情返回仪表盘列表或目录', 'P2', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['仪表盘阅读模式', '视图', '切换到只读模式，方便查看仪表盘', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['仪表盘编排模式', '操作', '切换到编辑模式，对仪表盘布局和组件进行编排', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['筛选 - 统计周期', '操作', '根据统计周期（如 2024.01~2025.10）筛选仪表盘数据', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['筛选 - 分析维度', '操作', '根据分析维度（如全部地区）筛选仪表盘数据', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['执行查询', '操作', '应用筛选条件并刷新仪表盘数据', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['保存看板', '操作', '保存当前仪表盘的配置和数据视图', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['下载仪表盘', '操作', '下载当前仪表盘的数据或报告', 'P2', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['分享仪表盘', '操作', '分享当前仪表盘给其他用户或生成分享链接', 'P2', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['全屏显示', '视图', '将仪表盘切换到全屏显示模式', 'P2', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['看板配置', '操作', '配置仪表盘的各项设置，如权限、数据源等', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '数据看板'],
  ['智能问答', '交互', '通过自然语言与 AI 助手进行问答，获取数据洞察', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '前台交互'],
  ['AI 助手 - 看板编辑', '交互', 'AI 提供基于自然语言理解的看板编辑辅助', 'P1', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '前台交互'],
  ['AI 助手 - 答案评分', '操作', '用户对 AI 助手的回答进行满意度评分', 'P2', '开发中', 'PM', '2.0-Alpha', '2.0-Alpha', '前台交互'],
];

const data = [headers, ...rows];
const ws = XLSX.utils.aoa_to_sheet(data);

// 设置列宽
ws['!cols'] = [
  { wch: 22 },
  { wch: 8 },
  { wch: 52 },
  { wch: 8 },
  { wch: 8 },
  { wch: 8 },
  { wch: 12 },
  { wch: 12 },
  { wch: 12 },
];

const wb = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(wb, ws, '数据看板功能表');

const outPath = path.join(__dirname, '..', '数据看板功能表.xlsx');
XLSX.writeFile(wb, outPath);

console.log('已导出: ' + outPath);
